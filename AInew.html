<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Body Rhythm Console - Beta</title>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
      background: #05060a;
      color: #f2f2f7;
      display: flex;
      height: 100vh;
    }
    .console {
      margin: auto;
      width: min(1150px, 95vw);
      height: min(720px, 92vh);
      border-radius: 24px;
      border: 2px solid #313446;
      display: grid;
      grid-template-columns: 2fr 1fr;
      background: radial-gradient(circle at top, #22263a 0, #090b13 40%, #05060a 80%);
      box-shadow: 0 22px 45px rgba(0,0,0,0.8);
      overflow: hidden;
    }

    /* Chat side */
    .chat {
      border-right: 1px solid #26293a;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }
    .chat-header {
      padding: 10px 14px;
      border-bottom: 1px solid #26293a;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: #9ba2ff;
      background: linear-gradient(to right, rgba(60,68,120,0.5), transparent);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .chat-messages {
      flex: 1;
      padding: 14px;
      overflow-y: auto;
      font-size: 14px;
    }
    .chat-msg {
      margin-bottom: 8px;
      line-height: 1.5;
    }
    .chat-msg strong {
      color: #d4d7ff;
    }
    .chat-input {
      display: flex;
      border-top: 1px solid #26293a;
    }
    .chat-input input {
      flex: 1;
      border: none;
      padding: 10px;
      background: #121522;
      color: #f2f2f7;
      outline: none;
      font-size: 14px;
    }
    .chat-input button {
      border: none;
      padding: 10px 16px;
      background: #2f7df6;
      color: white;
      font-size: 14px;
      cursor: pointer;
      border-radius: 0;
      white-space: nowrap;
    }
    .chat-input button:active {
      transform: translateY(1px);
    }

    /* Control side */
    .controls {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      overflow-y: auto;
      min-width: 0;
    }
    .panel {
      background: rgba(10,12,22,0.95);
      border-radius: 14px;
      padding: 10px 10px 12px 10px;
      border: 1px solid #2a3043;
    }
    .panel h3 {
      margin: 0 0 6px 0;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #a7b0ff;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .btn {
      flex: 1;
      min-width: 90px;
      padding: 6px 8px;
      font-size: 11px;
      border-radius: 999px;
      border: 1px solid #3a4058;
      background: #191e30;
      color: #f2f2f7;
      cursor: pointer;
      text-align: center;
    }
    .btn:active {
      transform: translateY(1px);
    }

    /* Mode toggle */
    .mode-row {
      display: flex;
      gap: 6px;
    }
    .mode-btn {
      flex: 1;
      padding: 6px 8px;
      font-size: 11px;
      border-radius: 999px;
      border: 1px solid #3a4058;
      background: #151829;
      color: #c4c8ef;
      cursor: pointer;
      text-align: center;
    }
    .mode-btn.active {
      background: #2f7df6;
      border-color: #4f8dff;
      color: #ffffff;
    }

    .slider-group {
      display: flex;
      flex-direction: column;
      gap: 3px;
      font-size: 12px;
      margin-bottom: 8px;
    }
    .slider-group label {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: #b3b7d2;
    }

    /* Bigger sliders for iPad */
    input[type="range"] {
      width: 100%;
      height: 26px;
      cursor: pointer;
      background: transparent;
    }
    input[type="range"]::-webkit-slider-runnable-track {
      height: 6px;
      background: #2b3147;
      border-radius: 3px;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2f7df6;
      border: 2px solid #ffffff33;
      margin-top: -7px;
    }
    input[type="range"]:focus {
      outline: none;
    }

    .mini-label {
      font-size: 10px;
      color: #7e84a8;
      margin-top: 2px;
    }

    .time-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4px 8px;
      font-size: 11px;
    }
    .time-grid label {
      display: flex;
      flex-direction: column;
      gap: 2px;
      color: #c1c6e3;
    }
    .time-grid input[type="time"],
    .time-grid select,
    .time-grid textarea {
      background: #151829;
      border: 1px solid #303651;
      border-radius: 6px;
      padding: 3px 4px;
      color: #f2f2f7;
      font-size: 11px;
      outline: none;
    }
    .time-grid textarea {
      resize: vertical;
      min-height: 40px;
    }
    .full-span {
      grid-column: 1 / -1;
    }

    .tag-row {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 4px;
    }
    .tag {
      font-size: 10px;
      border-radius: 999px;
      padding: 3px 6px;
      border: 1px solid #333a5b;
      color: #aab0d5;
    }

    .history-list {
      list-style: none;
      padding: 0;
      margin: 4px 0 0 0;
      font-size: 11px;
      color: #c5c9e5;
    }
    .history-list li {
      margin-bottom: 4px;
    }
    .history-label {
      font-weight: 600;
    }

    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-track {
      background: #090b13;
    }
    ::-webkit-scrollbar-thumb {
      background: #2d3145;
      border-radius: 3px;
    }

    @media (max-width: 800px) {
      .console {
        grid-template-columns: 1fr;
        height: auto;
      }
      .chat {
        border-right: none;
        border-bottom: 1px solid #26293a;
      }
    }
  </style>
</head>
<body>
  <div class="console">
    <!-- Chat side -->
    <div class="chat">
      <div class="chat-header">Body Rhythm Console · Beta</div>
      <div class="chat-messages" id="chatMessages">
        <div class="chat-msg">
          <strong>App:</strong> Welcome. This console helps you understand how your body actually works. Not through diets or diagnoses, but through timing, stress load, and your gut–brain rhythm.
        </div>
        <div class="chat-msg">
          <strong>App:</strong> Most long term IBS-like issues and anxiety driven physical symptoms follow patterns that no one ever maps. This tool helps you find your personal rhythm so your mornings become more predictable and your nervous system stays calmer.
        </div>
        <div class="chat-msg">
          <strong>App:</strong> Use the sliders to describe how you feel, set tonight’s timing, and then log and explore. You are not broken, you just have a pattern that has not been visible yet.
        </div>
      </div>
      <div class="chat-input">
        <input id="chatInput" placeholder="Type a note or question (optional, not wired to real AI yet)...">
        <button onclick="sendChat()">Send</button>
      </div>
    </div>
        <!-- Controls side -->
    <div class="controls">
      <!-- Mode toggle -->
      <div class="panel">
        <h3>Mode</h3>
        <div class="mode-row">
          <button class="mode-btn active" id="modeIbs" onclick="setMode('ibs')">IBS / Morning rhythm</button>
          <button class="mode-btn" id="modeAnx" onclick="setMode('anx')">Anxiety / Crash timing</button>
        </div>
        <p class="mini-label">
          IBS / Morning rhythm: evening timing and morning bathroom pattern.
          <br>
          Anxiety / Crash timing: sugar, caffeine, sleep, and crash windows.
        </p>
      </div>

      <!-- IBS panel -->
      <div id="ibsPanel">
        <!-- Step 1 -->
        <div class="panel">
          <h3>Step 1 · How do you feel right now?</h3>
          <div class="slider-group">
            <label>
              <span>Stress</span>
              <span id="stressVal">2/10</span>
            </label>
            <input type="range" id="stress" min="0" max="10" value="2" oninput="updateLabel('stress')">
          </div>
          <div class="slider-group">
            <label>
              <span>Shoulder tension</span>
              <span id="shoulderVal">3/10</span>
            </label>
            <input type="range" id="shoulder" min="0" max="10" value="3" oninput="updateLabel('shoulder')">
          </div>
          <div class="slider-group">
            <label>
              <span>Gut comfort</span>
              <span id="gutVal">6/10</span>
            </label>
            <input type="range" id="gut" min="0" max="10" value="6" oninput="updateLabel('gut')">
          </div>
          <div class="slider-group">
            <label>
              <span>Anxiety level</span>
              <span id="anxVal">3/10</span>
            </label>
            <input type="range" id="anx" min="0" max="10" value="3" oninput="updateLabel('anx')">
          </div>
          <p class="mini-label">
            Set these to match how your body and nervous system feel right now.
          </p>
        </div>

        <!-- Step 2 -->
        <div class="panel">
          <h3>Step 2 · Tonight's timing</h3>
          <div class="time-grid">
            <label>
              Dinner
              <input type="time" id="dinTime" value="19:00">
            </label>
            <label>
              Last food
              <input type="time" id="foodTime" value="19:45">
            </label>
            <label>
              Last drink
              <input type="time" id="drinkTime" value="21:30">
            </label>
            <label>
              Magnesium glycinate
              <input type="time" id="magTime" value="23:00">
            </label>
            <label>
              Sleep
              <input type="time" id="sleepTime" value="00:30">
            </label>
            <label>
              Wake
              <input type="time" id="wakeTime" value="08:00">
            </label>
            <label class="full-span">
              Last meal eaten
              <textarea id="ibsMeal" style="min-height:32px;"
                placeholder="Chicken and rice, cereal + banana, salad, pizza..."></textarea>
            </label>
          </div>
          <p class="mini-label">
            Keep it simple. You do not need grams, just a quick description of the last plate.
          </p>
        </div>

        <!-- Step 3 -->
        <div class="panel">
          <h3>Step 3 · What do you want to do?</h3>
          <div class="btn-row">
            <button class="btn" onclick="preset('log_today')">Save today to history</button>
            <button class="btn" onclick="preset('insight')">Show me today’s pattern</button>
            <button class="btn" onclick="preset('forecast')">Predict tomorrow morning</button>
          </div>
          <div class="btn-row" style="margin-top:4px;">
            <button class="btn" onclick="preset('explain')">Explain my system</button>
            <button class="btn" onclick="preset('driving')">What is driving today?</button>
            <button class="btn" onclick="preset('questions')">Ask me questions</button>
          </div>
        </div>

        <!-- Step 4 -->
        <div class="panel">
          <h3>Step 4 · Morning outcome</h3>
          <div class="time-grid">
            <label>
              BM time
              <input type="time" id="bmTime" value="08:05">
            </label>
            <label>
              Pain level
              <input type="range" id="bmPain" min="0" max="10" value="2" oninput="updateLabel('pain')">
              <span id="bmPainVal" style="font-size:10px;color:#b3b7d2;">2/10</span>
            </label>
            <label>
              Bristol form
              <select id="bmForm">
                <option value="1">1 · Separate hard lumps</option>
                <option value="2">2 · Lumpy sausage</option>
                <option value="3">3 · Cracked sausage</option>
                <option value="4" selected>4 · Smooth, soft sausage</option>
                <option value="5">5 · Soft blobs, clear edges</option>
                <option value="6">6 · Fluffy, mushy</option>
                <option value="7">7 · Watery, no solids</option>
              </select>
            </label>
          </div>
          <p class="mini-label">
            This is what actually happened in the morning. Later, this feeds into pattern detection so you can see how last night’s timing and state match your outcomes.
          </p>
        </div>

        <!-- Recent days -->
        <div class="panel">
          <h3>Recent days</h3>
          <ul id="historyList" class="history-list"></ul>
          <p class="mini-label">
            These are quick summaries saved on this device only. They show how your last few evenings and mornings fit into stable, sensitive, or in between patterns.
          </p>
        </div>
      </div>
            <!-- Anxiety panel -->
      <div id="anxPanel" style="display:none;">
        <div class="panel">
          <h3>Anxiety quick actions</h3>
          <div class="btn-row">
            <button class="btn" onclick="anxAction('log')">Log anxiety day</button>
            <button class="btn" onclick="anxAction('forecast')">Show spike / crash time</button>
          </div>
          <div class="btn-row" style="margin-top:4px;">
            <button class="btn" onclick="anxAction('explain')">Explain today</button>
            <button class="btn" onclick="anxAction('questions')">Ask me questions</button>
          </div>
        </div>

        <div class="panel">
          <h3>Anxiety day inputs</h3>
          <div class="time-grid">
            <label>
              Main carb / sugar hit
              <input type="time" id="anxHitTime" value="14:00">
            </label>
            <label>
              Sugar / carb load
              <input type="range" id="anxSugar" min="0" max="10" value="5" oninput="updateAnxLabel('sugar')">
              <span id="anxSugarVal" style="font-size:10px;color:#b3b7d2;">5/10</span>
            </label>
            <label>
              Caffeine today
              <input type="range" id="anxCaf" min="0" max="10" value="2" oninput="updateAnxLabel('caf')">
              <span id="anxCafVal" style="font-size:10px;color:#b3b7d2;">2/10</span>
            </label>
            <label>
              Sleep quality
              <input type="range" id="anxSleep" min="0" max="10" value="6" oninput="updateAnxLabel('sleep')">
              <span id="anxSleepVal" style="font-size:10px;color:#b3b7d2;">6/10</span>
            </label>
            <label>
              Baseline sensitivity
              <input type="range" id="anxSens" min="0" max="10" value="5" oninput="updateAnxLabel('sens')">
              <span id="anxSensVal" style="font-size:10px;color:#b3b7d2;">5/10</span>
            </label>
            <label class="full-span">
              Foods and notes
              <textarea id="anxFoods" placeholder="Small bowl of cereal, 2 cookies, soda before bed, etc..."></textarea>
            </label>
          </div>
          <p class="mini-label">
            In the full version, this foods box will feed the AI so it can estimate how heavy the sugar / carb load was and fold it into the spike and crash timing.
          </p>
        </div>
      </div>
    </div>
  </div>
        <!-- Anxiety panel -->
      <div id="anxPanel" style="display:none;">
        <div class="panel">
          <h3>Anxiety quick actions</h3>
          <div class="btn-row">
            <button class="btn" onclick="anxAction('log')">Log anxiety day</button>
            <button class="btn" onclick="anxAction('forecast')">Show spike / crash time</button>
          </div>
          <div class="btn-row" style="margin-top:4px;">
            <button class="btn" onclick="anxAction('explain')">Explain today</button>
            <button class="btn" onclick="anxAction('questions')">Ask me questions</button>
          </div>
        </div>

        <div class="panel">
          <h3>Anxiety day inputs</h3>
          <div class="time-grid">
            <label>
              Main carb / sugar hit
              <input type="time" id="anxHitTime" value="14:00">
            </label>
            <label>
              Sugar / carb load
              <input type="range" id="anxSugar" min="0" max="10" value="5" oninput="updateAnxLabel('sugar')">
              <span id="anxSugarVal" style="font-size:10px;color:#b3b7d2;">5/10</span>
            </label>
            <label>
              Caffeine today
              <input type="range" id="anxCaf" min="0" max="10" value="2" oninput="updateAnxLabel('caf')">
              <span id="anxCafVal" style="font-size:10px;color:#b3b7d2;">2/10</span>
            </label>
            <label>
              Sleep quality
              <input type="range" id="anxSleep" min="0" max="10" value="6" oninput="updateAnxLabel('sleep')">
              <span id="anxSleepVal" style="font-size:10px;color:#b3b7d2;">6/10</span>
            </label>
            <label>
              Baseline sensitivity
              <input type="range" id="anxSens" min="0" max="10" value="5" oninput="updateAnxLabel('sens')">
              <span id="anxSensVal" style="font-size:10px;color:#b3b7d2;">5/10</span>
            </label>
            <label class="full-span">
              Foods and notes
              <textarea id="anxFoods" placeholder="Small bowl of cereal, 2 cookies, soda before bed, etc..."></textarea>
            </label>
          </div>
          <p class="mini-label">
            In the full version, this foods box will feed the AI so it can estimate how heavy the sugar / carb load was and fold it into the spike and crash timing.
          </p>
        </div>
      </div>
    </div>
  </div>
